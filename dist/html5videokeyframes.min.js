xml2json={parser:function(t,e,n){e||(e=""),t=t.replace(/\s*\/>/g,"/>"),t=t.replace(/<\?[^>]*>/g,"").replace(/<\![^>]*>/g,""),e.sort||(e=e.split(","));var r=this.no_fast_endings(t);r=this.attris_to_tags(r),r=escape(r),r=r.split("%3C").join("<").split("%3E").join(">").split("%3D").join("=").split("%22").join('"');for(var o=0;o<e.length;o++)r=r.replace(new RegExp("<"+e[o]+">","g"),"*$**"+e[o]+"**$*"),r=r.replace(new RegExp("</"+e[o]+">","g"),"*$***"+e[o]+"**$*");r="<JSONTAGWRAPPER>"+r+"</JSONTAGWRAPPER>",this.xmlobject={};var i=this.xml_to_object(r).jsontagwrapper;return n&&(i=this.show_json_structure(i,n)),i},xml_to_object:function(xmlcode){var x=xmlcode.replace(/<\//g,"ยง");x=x.split("<");for(var y=[],level=0,opentags=[],i=1;i<x.length;i++){var tagname=x[i].split(">")[0];for(opentags.push(tagname),level++,y.push(level+"<"+x[i].split("ยง")[0]);x[i].indexOf("ยง"+opentags[opentags.length-1]+">")>=0;)level--,opentags.pop()}for(var oldniva=-1,objname="this.xmlobject",i=0;i<y.length;i++){var preeval="",niva=y[i].split("<")[0],tagnamn=y[i].split("<")[1].split(">")[0];tagnamn=tagnamn.toLowerCase();var rest=y[i].split(">")[1];if(oldniva>=niva)for(var tabort=oldniva-niva+1,j=0;tabort>j;j++)objname=objname.substring(0,objname.lastIndexOf("."));objname+="."+tagnamn;var pobject=objname.substring(0,objname.lastIndexOf("."));"object"!=eval("typeof "+pobject)&&(preeval+=pobject+"={value:"+pobject+"};\n");var objlast=objname.substring(objname.lastIndexOf(".")+1),already=!1;for(k in eval(pobject))k==objlast&&(already=!0);for(var onlywhites=!0,s=0;s<rest.length;s+=3)"%"!=rest.charAt(s)&&(onlywhites=!1);""==rest||onlywhites?rest="{}":rest/1!=rest&&(rest="'"+rest.replace(/\'/g,"\\'")+"'",rest=rest.replace(/\*\$\*\*\*/g,"</"),rest=rest.replace(/\*\$\*\*/g,"<"),rest=rest.replace(/\*\*\$\*/g,">")),"'"==rest.charAt(0)&&(rest="unescape("+rest+")"),already&&!eval(objname+".sort")&&(preeval+=objname+"=["+objname+"];\n");var before="=";after="",already&&(before=".push(",after=")");var toeval=preeval+objname+before+rest+after;eval(toeval),eval(objname+".sort")&&(objname+="["+eval(objname+".length-1")+"]"),oldniva=niva}return this.xmlobject},show_json_structure:function(t,e,n){var r="";r+=t.sort?"[\n":"{\n";for(var o in t)if(t.sort||(r+=o+":"),"object"==typeof t[o])r+=this.show_json_structure(t[o],!1,1);else if("function"==typeof t[o]){var i=t[o]+"";r+=i}else r+="string"!=typeof t[o]?t[o]+",\n":"'"+t[o].replace(/\'/g,"\\'").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r")+"',\n";if(r+=t.sort?"],\n":"},\n",!n){r=r.substring(0,r.lastIndexOf(",")),r=r.replace(new RegExp(",\n}","g"),"\n}"),r=r.replace(new RegExp(",\n]","g"),"\n]");var s=r.split("\n");r="";for(var a=0,o=0;o<s.length;o++){(s[o].indexOf("}")>=0||s[o].indexOf("]")>=0)&&a--,tabs="";for(var u=0;a>u;u++)tabs+="	";r+=tabs+s[o]+"\n",(s[o].indexOf("{")>=0||s[o].indexOf("[")>=0)&&a++}"html"==e&&(r=r.replace(/</g,"&lt;").replace(/>/g,"&gt;"),r=r.replace(/\n/g,"<BR>").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;")),"compact"==e&&(r=r.replace(/\n/g,"").replace(/\t/g,""))}return r},no_fast_endings:function(t){t=t.split("/>");for(var e=1;e<t.length;e++){var n=t[e-1].substring(t[e-1].lastIndexOf("<")+1).split(" ")[0];t[e]="></"+n+">"+t[e]}return t=t.join("")},attris_to_tags:function(t){var e=" =\"'".split("");t=t.split(">");for(var n=0;n<t.length;n++){for(var r=t[n].split("<"),o=0;4>o;o++)r[0]=r[0].replace(new RegExp(e[o],"g"),"_jsonconvtemp"+o+"_");if(r[1]){r[1]=r[1].replace(/'/g,'"'),r[1]=r[1].split('"');for(var i=1;i<r[1].length;i+=2)for(var o=0;4>o;o++)r[1][i]=r[1][i].replace(new RegExp(e[o],"g"),"_jsonconvtemp"+o+"_");r[1]=r[1].join('"')}t[n]=r.join("<")}t=t.join(">"),t=t.replace(/ ([^=]*)=([^ |>]*)/g,"><$1>$2</$1"),t=t.replace(/>"/g,">").replace(/"</g,"<");for(var o=0;4>o;o++)t=t.replace(new RegExp("_jsonconvtemp"+o+"_","g"),e[o]);return t}},Array.prototype.push||(Array.prototype.push=function(t){return this[this.length]=t,!0}),Array.prototype.pop||(Array.prototype.pop=function(){var t=this[this.length-1];return this.length--,t}),function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function e(t){return"function"==typeof t}function n(t){return"object"==typeof t&&null!==t}function r(){}function o(){return function(){process.nextTick(u)}}function i(){var t=0,e=new N(u),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function s(){var t=new MessageChannel;return t.port1.onmessage=u,function(){t.port2.postMessage(0)}}function a(){return function(){setTimeout(u,1)}}function u(){for(var t=0;I>t;t+=2){var e=Y[t],n=Y[t+1];e(n),Y[t]=void 0,Y[t+1]=void 0}I=0}function c(){}function l(){return new TypeError("You cannot resolve a promise with itself")}function p(){return new TypeError("A promises callback cannot return that same promise.")}function f(t){try{return t.then}catch(e){return F.error=e,F}}function h(t,e,n,r){try{t.call(e,n,r)}catch(o){return o}}function v(t,e,n){M(function(t){var r=!1,o=h(n,e,function(n){r||(r=!0,e!==n?m(t,n):b(t,n))},function(e){r||(r=!0,y(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,y(t,o))},t)}function g(t,e){e._state===J?b(t,e._result):t._state===B?y(t,e._result):j(e,void 0,function(e){m(t,e)},function(e){y(t,e)})}function _(t,n){if(n.constructor===t.constructor)g(t,n);else{var r=f(n);r===F?y(t,F.error):void 0===r?b(t,n):e(r)?v(t,n,r):b(t,n)}}function m(e,n){e===n?y(e,l()):t(n)?_(e,n):b(e,n)}function d(t){t._onerror&&t._onerror(t._result),w(t)}function b(t,e){t._state===G&&(t._result=e,t._state=J,0===t._subscribers.length||M(w,t))}function y(t,e){t._state===G&&(t._state=B,t._result=e,M(d,t))}function j(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+J]=n,o[i+B]=r,0===i&&t._state&&M(w,t)}function w(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r,o,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?E(n,r,o,i):o(i);t._subscribers.length=0}}function x(){this.error=null}function A(t,e){try{return t(e)}catch(n){return K.error=n,K}}function E(t,n,r,o){var i,s,a,u,c=e(r);if(c){if(i=A(r,o),i===K?(u=!0,s=i.error,i=null):a=!0,n===i)return void y(n,p())}else i=o,a=!0;n._state!==G||(c&&a?m(n,i):u?y(n,s):t===J?b(n,i):t===B&&y(n,i))}function O(t,e){try{e(function(e){m(t,e)},function(e){y(t,e)})}catch(n){y(t,n)}}function R(t,e,n,r){this._instanceConstructor=t,this.promise=new t(c,r),this._abortOnReject=n,this._validateInput(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._init(),0===this.length?b(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&b(this.promise,this._result))):y(this.promise,this._validationError())}function P(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function T(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function S(t){this._id=Q++,this._state=void 0,this._result=void 0,this._subscribers=[],c!==t&&(e(t)||P(),this instanceof S||T(),O(this,t))}var $;$=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var k,C=$,I=(Date.now||function(){return(new Date).getTime()},Object.create||function(t){if(arguments.length>1)throw new Error("Second argument not supported");if("object"!=typeof t)throw new TypeError("Argument must be an object");return r.prototype=t,new r},0),M=function(t,e){Y[I]=t,Y[I+1]=e,I+=2,2===I&&k()},D="undefined"!=typeof window?window:{},N=D.MutationObserver||D.WebKitMutationObserver,W="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Y=new Array(1e3);k="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?o():N?i():W?s():a();var G=void 0,J=1,B=2,F=new x,K=new x;R.prototype._validateInput=function(t){return C(t)},R.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},R.prototype._init=function(){this._result=new Array(this.length)};var L=R;R.prototype._enumerate=function(){for(var t=this.length,e=this.promise,n=this._input,r=0;e._state===G&&t>r;r++)this._eachEntry(n[r],r)},R.prototype._eachEntry=function(t,e){var r=this._instanceConstructor;n(t)?t.constructor===r&&t._state!==G?(t._onerror=null,this._settledAt(t._state,e,t._result)):this._willSettleAt(r.resolve(t),e):(this._remaining--,this._result[e]=this._makeResult(J,e,t))},R.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===G&&(this._remaining--,this._abortOnReject&&t===B?y(r,n):this._result[e]=this._makeResult(t,e,n)),0===this._remaining&&b(r,this._result)},R.prototype._makeResult=function(t,e,n){return n},R.prototype._willSettleAt=function(t,e){var n=this;j(t,void 0,function(t){n._settledAt(J,e,t)},function(t){n._settledAt(B,e,t)})};var U=function(t,e){return new L(this,t,!0,e).promise},q=function(t,e){function n(t){m(i,t)}function r(t){y(i,t)}var o=this,i=new o(c,e);if(!C(t))return y(i,new TypeError("You must pass an array to race.")),i;for(var s=t.length,a=0;i._state===G&&s>a;a++)j(o.resolve(t[a]),void 0,n,r);return i},z=function(t,e){var n=this;if(t&&"object"==typeof t&&t.constructor===n)return t;var r=new n(c,e);return m(r,t),r},H=function(t,e){var n=this,r=new n(c,e);return y(r,t),r},Q=0,V=S;S.all=U,S.race=q,S.resolve=z,S.reject=H,S.prototype={constructor:S,then:function(t,e){var n=this,r=n._state;if(r===J&&!t||r===B&&!e)return this;var o=new this.constructor(c),i=n._result;if(r){var s=arguments[r-1];M(function(){E(r,o,s,i)})}else j(n,o,t,e);return o},"catch":function(t){return this.then(null,t)}};var X=function(){var t;t="undefined"!=typeof global?global:"undefined"!=typeof window&&window.document?window:self;var n="Promise"in t&&"resolve"in t.Promise&&"reject"in t.Promise&&"all"in t.Promise&&"race"in t.Promise&&function(){var n;return new t.Promise(function(t){n=t}),e(n)}();n||(t.Promise=V)},Z={Promise:V,polyfill:X};"function"==typeof define&&define.amd?define(function(){return Z}):"undefined"!=typeof module&&module.exports?module.exports=Z:"undefined"!=typeof this&&(this.ES6Promise=Z)}.call(this);
!function(window,document,undefined){"use strict";function HTML5VideoKeyframes(e){return _instance=this,e.wrapper?e.props?(this._videoElement=document.getElementById(_createVideoPlayer(e.wrapper,e.props)),this._buffered=!1,this._interval=null,this._keyframes=null,e.keyframes?void _instance._loadData(e.keyframes).then(function(e){_instance._parseData(e)},function(e){console.log("Error loading data",e)}):void console.log("No keyframe xml defined")):void console.log("No video properties defined"):void console.log("No wrapper id defined")}var vkf={get:function(){return _instance},init:function(e){return _instance||new HTML5VideoKeyframes(e)},VERSION:"0.0.01"};HTML5VideoKeyframes.prototype.gotoAndPlay=function(e){_instance._keyframeState().then(function(){var n,t,o;e.constructor===Object?(n=e.name,o=e.onBegin||undefined,t=e.onComplete||undefined):e.constructor===String&&(n=e);var r=_keyframeByName(_instance,n);r.onComplete=t?t:r.complete,r.onBegin=o?o:r.begin,_instance._seekTo(r.start),_instance._startInterval(r),_instance._play()},function(){setTimeout(function(){_instance.gotoAndPlay(e)},50)})},HTML5VideoKeyframes.prototype.stop=function(){_instance._stop()},HTML5VideoKeyframes.prototype.play=function(){_instance._play()},HTML5VideoKeyframes.prototype.pause=function(){_instance._pause()},HTML5VideoKeyframes.prototype.destroy=function(){clearInterval(_instance._interval),_instance=null};var _instance;HTML5VideoKeyframes.prototype._loadData=function(e){return new Promise(function(n,t){var o=new XMLHttpRequest;o.open("GET",e,!0),o.setRequestHeader("Content-type","text/xml"),o.onreadystatechange=function(){switch(this.readyState){case 0:break;case 1:break;case 2:break;case 3:break;case 4:200==o.status?n(o.responseText):t(o.statusText)}},o.onerror=function(){t("Network Error")},o.send()})},HTML5VideoKeyframes.prototype._parseData=function(e){_instance._keyframes=xml2json.parser(e).keyframes},HTML5VideoKeyframes.prototype._keyframeState=function(){return new Promise(function(e,n){_instance._keyframes?e():n()})},HTML5VideoKeyframes.prototype._bufferState=function(){return new Promise(function(e,n){_instance.buffer?_instance.buffer&&_instance.buffered?e():n():e()})},HTML5VideoKeyframes.prototype._startInterval=function(e){e.onBegin&&_ononKeyframeEvent(_instance,e.onBegin,e),_instance._stopInterval(),_instance._interval=setInterval(function(){_instance._monitorInterval(e)},10)},HTML5VideoKeyframes.prototype._stopInterval=function(){try{clearInterval(_instance._interval)}catch(e){}},HTML5VideoKeyframes.prototype._monitorInterval=function(e){if(Math.round(_instance._videoElement.currentTime)===Math.round(e.end)){var n=1%(this._videoElement.currentTime/e.end);(0===n||1===n)&&(_instance._stopInterval(),_instance._pause(),e.onComplete&&_onKeyframeEvent(_instance,e.onComplete,e))}},HTML5VideoKeyframes.prototype._seekTo=function(e){try{_instance._videoElement.currentTime=e}catch(n){}},HTML5VideoKeyframes.prototype._play=function(){_instance._videoElement.play()},HTML5VideoKeyframes.prototype._stop=function(){_instance._videoElement.currentTime=0,_instance._videoElement.pause()},HTML5VideoKeyframes.prototype._pause=function(){_instance._videoElement.pause()},HTML5VideoKeyframes.prototype._loop=function(e){_instance._seekTo(e.start),_instance._startInterval(e),_instance._play()};var _createVideoPlayer=function(e,n){var t=document.getElementById(e),o=n.id||"video-"+_randomString(5),r=n.forceReload?"?v="+_randomString(20):"",s="<video ";return s+='width="',s+=n.width||320,s+='" height="',s+=n.height||240,s+='" id="'+o+'" ',n.attrs.muted&&(s+="muted "),n.attrs.controls&&(s+="controls "),n.attrs.poster&&(s+='poster="'+n.attrs.poster+'" '),n.attrs.title&&(s+='title="'+n.attrs.title+'" '),s+='preload="auto">',n.srcs.mp4&&(s+='<source src="'+n.srcs.mp4+r+'" type="video/mp4">'),n.srcs.ogg&&(s+='<source src="'+n.srcs.ogg+r+'" type="video/ogg">'),n.srcs.webm&&(s+='<source src="'+n.srcs.ogg+r+'" type="video/webm">'),s+="</video>",t.innerHTML=s,o},_onKeyframeEvent=function(e,n,t){if(n.constructor===String)_processEventsFromString(e,n,t);else if(n.constructor===Object){if(!n.func)return void console.log("Malformed params passed");if(n.func.constructor===Array)for(var o=0;o<n.func.length;o++)n.func[o].constructor===String?_processEventsFromString(e,n.func[o],t):n.func[o].constructor===Object&&_processKeyframeFunction(n.func[o]);else n.func.constructor===Object&&_processKeyframeFunction(n.func)}},_processEventsFromString=function(e,n,t){switch(n){case"stop":e._stop();break;case"loop":e._loop(t);break;case"pause":e._pause();break;default:e._pause()}},_processKeyframeFunction=function(func){var scope=func.scope?func.scope:_instance;scope.constructor===String&&(scope=eval(scope)),scope.constructor===Object&&(scope=_instance);try{scope[func.name](func.params)}catch(e){console.log("function "+func.name+" with scope "+scope+" is undefined!")}},_keyframeByName=function(e,n){for(var t=e._keyframes.keyframe,o=0;o<t.length;o++)if(t[o].name==n)return t[o];return null},_randomString=function(e){for(var n="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;e>o;o++)n+=t.charAt(Math.floor(Math.random()*t.length));return n},_promisePolyfill=function(){try{new Promise}catch(e){ES6Promise.polyfill()}};_promisePolyfill(),"function"==typeof define&&define.amd?define([],function(){return vkf}):"undefined"!=typeof module&&module.exports?module.exports=vkf:window.vkf=vkf}(window,document);